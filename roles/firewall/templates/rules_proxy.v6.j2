{{ ansible_managed | comment }}

# Generated by ip6tables-save v1.6.1 on Thu Jun 20 10:00:00 2020
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -p udp -m udp --dport 443 -j ACCEPT
-A INPUT -i lo -m comment --comment "Allow lo interface" -j ACCEPT
-A INPUT -i wg0 -m comment --comment "Allow wg0 interface" -j ACCEPT
-A INPUT -p ipv6-icmp -m comment --comment "Allow icmpv6" -j ACCEPT
-A INPUT -d fe80::/64 -p udp -m conntrack --ctstate NEW -m udp --dport 546 -m comment --comment "Allow DHCPv6" -j ACCEPT
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -m comment --comment "Allow existing connections" -j ACCEPT
-A INPUT -p tcp -m conntrack --ctstate NEW -m tcp --dport 22 -m comment --comment "Allow SSH" -j ACCEPT
{% if wireguard_port is not none %}
-A INPUT -p udp -m conntrack --ctstate NEW -m udp --dport {{ wireguard_port }} -m comment --comment "Allow wireguard" -j ACCEPT
{% endif %}
{% if monitoring_host_ipv6 is not none %}
-A INPUT -s {{ monitoring_host_ipv6 }}/128 -p udp -m udp --dport 161 -m comment --comment "Allow Monitoring" -j ACCEPT
-A INPUT -s {{ monitoring_host_ipv6 }}/128 -p tcp -m tcp --dport 9100 -m comment --comment "Allow Monitoring" -j ACCEPT
{% endif %}
-A INPUT -p tcp -m conntrack --ctstate NEW -m tcp --dport 80 -m comment --comment "Allow HTTP" -j ACCEPT
-A INPUT -p tcp -m conntrack --ctstate NEW -m tcp --dport 443 -m comment --comment "Allow HTTPS" -j ACCEPT
COMMIT
# Completed on Thu Jun 20 10:00:00 2020
# Generated by ip6tables-save v1.6.1 on Thu Jun 20 10:00:00 2020
*nat
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
COMMIT
# Completed on Thu Jun 20 10:00:00 2020
